# 快速部署指南

## 方法 1: 通过 Git 自动部署（推荐）

如果您的项目已经连接到 Git 仓库（GitHub/GitLab 等），这是最简单的方法：

### 1. 提交所有更改
```bash
git add .
git commit -m "修复 Vercel API 部署问题 - 添加专门的 API 入口文件"
git push origin main
```

### 2. Vercel 会自动检测到更改并重新部署
- 登录 Vercel 控制台查看部署状态
- 部署完成后测试 API 端点

## 方法 2: 使用 Vercel CLI

### 1. 安装 Vercel CLI（如果还没安装）
```bash
npm install -g vercel
```

### 2. 登录 Vercel
```bash
vercel login
```

### 3. 部署
```bash
# 构建项目
npm run build

# 部署到生产环境
vercel --prod
```

## 方法 3: 通过 Vercel 网页界面

1. 登录 [Vercel 控制台](https://vercel.com/dashboard)
2. 找到您的项目
3. 点击 "Redeploy" 按钮
4. 选择最新的 commit 进行部署

## 验证部署

部署完成后，测试以下端点：

### 1. 健康检查
```bash
curl https://api-g.lacs.cc/
```
应该返回 JSON 格式的响应，包含服务状态信息。

### 2. API 端点测试
```bash
# 测试 exchange-token 端点
curl -X POST https://api-g.lacs.cc/appweb/auth/exchange-token \
  -H "Content-Type: application/json" \
  -d '{"code":"test"}'
```
应该返回中文错误消息（因为没有有效的 GitHub 配置）。

### 3. 404 测试
```bash
curl https://api-g.lacs.cc/nonexistent
```
应该返回中文 404 错误消息，包含可用端点列表。

## 环境变量配置

确保在 Vercel 项目设置中配置了以下环境变量：

```
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
UMAMI_WEBSITE_ID=your_umami_website_id
UMAMI_API_TOKEN=your_umami_api_token
UMAMI_API_URL=your_umami_api_url
```

## 修复内容总结

✅ 创建了专门的 Vercel API 入口文件 (`api/index.ts`)
✅ 更新了 Vercel 配置 (`vercel.json`)
✅ 修复了 TypeScript 配置和模块导入
✅ 添加了详细的中文错误消息
✅ 移除了静态文件服务干扰

现在您的 API 应该能正确返回 JSON 响应而不是 HTML 错误页面。
